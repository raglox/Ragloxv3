# ═══════════════════════════════════════════════════════════════════════════════
# RAGLOX v3.0 - Production Environment Configuration
# SECURITY WARNING: Keep this file secure and never commit to version control!
# ═══════════════════════════════════════════════════════════════════════════════

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Application Settings                                                         │
# └─────────────────────────────────────────────────────────────────────────────┘
APP_NAME=RAGLOX
APP_VERSION=3.0.0
APP_ENV=production
DEBUG=false
DEV_MODE=false
LOG_LEVEL=INFO
LOG_FORMAT=json

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ API Configuration                                                            │
# └─────────────────────────────────────────────────────────────────────────────┘
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=false
# Restrict CORS in production - comma separated origins
CORS_ORIGINS=https://your-frontend.com,https://api.your-domain.com

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Security Settings - MUST CHANGE BEFORE DEPLOYMENT!                           │
# └─────────────────────────────────────────────────────────────────────────────┘
# Generate secure JWT secret: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET=CHANGE_ME_GENERATE_WITH_python_-c_import_secrets_print_secrets.token_urlsafe_64
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# Generate encryption key: python -c "import os,base64; print(base64.b64encode(os.urandom(32)).decode())"
ENCRYPTION_KEY=CHANGE_ME_GENERATE_32_BYTE_BASE64_KEY

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ PostgreSQL Configuration                                                     │
# └─────────────────────────────────────────────────────────────────────────────┘
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://raglox:YOUR_SECURE_PASSWORD@postgres:5432/raglox
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Redis Configuration                                                          │
# └─────────────────────────────────────────────────────────────────────────────┘
REDIS_URL=redis://redis:6379/0
REDIS_PASSWORD=YOUR_REDIS_PASSWORD

# Redis High Availability (REL-01)
# Options: standalone, sentinel, cluster
REDIS_MODE=standalone
# For Sentinel mode:
# REDIS_MODE=sentinel
# REDIS_SENTINEL_HOSTS=sentinel1:26379,sentinel2:26379,sentinel3:26379
# REDIS_SENTINEL_MASTER=mymaster

# For Cluster mode:
# REDIS_MODE=cluster
# REDIS_CLUSTER_NODES=redis1:6379,redis2:6379,redis3:6379

REDIS_MAX_CONNECTIONS=100
REDIS_HEALTH_CHECK_INTERVAL=30
REDIS_RECONNECT_MAX_ATTEMPTS=10
REDIS_SOCKET_TIMEOUT=5.0

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Approval Persistence (REL-02)                                                │
# └─────────────────────────────────────────────────────────────────────────────┘
APPROVAL_TTL_PENDING=86400
APPROVAL_TTL_COMPLETED=604800
CHAT_HISTORY_TTL=2592000
APPROVAL_AUDIT_TTL=7776000

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ LLM Provider Configuration                                                   │
# └─────────────────────────────────────────────────────────────────────────────┘
LLM_ENABLED=true

# Provider options: openai, blackbox, anthropic, local, mock
LLM_PROVIDER=openai

# ═══════════════════════════════════════════════════════════════
# Option 1: OpenAI (Recommended for production)
# ═══════════════════════════════════════════════════════════════
OPENAI_API_KEY=sk-YOUR_OPENAI_API_KEY_HERE
LLM_API_BASE=https://api.openai.com/v1
LLM_MODEL=gpt-4
# For GPT-4o-mini (cheaper, faster):
# LLM_MODEL=gpt-4o-mini

# ═══════════════════════════════════════════════════════════════
# Option 2: Azure OpenAI
# ═══════════════════════════════════════════════════════════════
# LLM_PROVIDER=openai
# OPENAI_API_KEY=YOUR_AZURE_API_KEY
# LLM_API_BASE=https://YOUR_RESOURCE.openai.azure.com/
# LLM_MODEL=YOUR_DEPLOYMENT_NAME

# ═══════════════════════════════════════════════════════════════
# Option 3: Anthropic Claude
# ═══════════════════════════════════════════════════════════════
# LLM_PROVIDER=anthropic
# LLM_API_KEY=YOUR_ANTHROPIC_API_KEY
# LLM_MODEL=claude-3-opus-20240229

# ═══════════════════════════════════════════════════════════════
# Option 4: BlackBox AI (Free tier)
# ═══════════════════════════════════════════════════════════════
# LLM_PROVIDER=blackbox
# LLM_API_BASE=https://api.blackbox.ai
# LLM_MODEL=blackboxai/openai/gpt-4o-mini

# ═══════════════════════════════════════════════════════════════
# Option 5: Local LLM (Ollama, LM Studio)
# ═══════════════════════════════════════════════════════════════
# LLM_PROVIDER=local
# LLM_API_BASE=http://localhost:11434/v1
# LLM_MODEL=llama2

# LLM Generation Parameters
LLM_TEMPERATURE=0.3
LLM_MAX_TOKENS=4096
LLM_TIMEOUT=60
LLM_MAX_RETRIES=3
LLM_FALLBACK_ENABLED=true

# LLM Safety Limits (Cost Control)
LLM_MAX_COST_LIMIT=10.0
LLM_DAILY_REQUESTS_LIMIT=500
LLM_MISSION_REQUESTS_LIMIT=50
LLM_COST_PER_1K_TOKENS=0.002
LLM_SAFETY_MODE=true

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ MinIO / S3 Storage Configuration                                             │
# └─────────────────────────────────────────────────────────────────────────────┘
S3_ENDPOINT=http://minio:9000
MINIO_ACCESS_KEY=raglox_access
MINIO_SECRET_KEY=YOUR_MINIO_SECRET_KEY

# For AWS S3:
# S3_ENDPOINT=https://s3.amazonaws.com
# AWS_ACCESS_KEY_ID=YOUR_AWS_ACCESS_KEY
# AWS_SECRET_ACCESS_KEY=YOUR_AWS_SECRET_KEY
# S3_REGION=us-east-1

S3_BUCKET_PAYLOADS=raglox-payloads
S3_BUCKET_REPORTS=raglox-reports
S3_BUCKET_LOGS=raglox-logs
S3_BUCKET_EVIDENCE=raglox-evidence

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Security Middleware (SEC-03, SEC-04)                                         │
# └─────────────────────────────────────────────────────────────────────────────┘
# Input Validation (SEC-03)
SECURITY_VALIDATION_ENABLED=true
SECURITY_CHECK_XSS=true
SECURITY_CHECK_SQL=true
SECURITY_CHECK_COMMAND=true
SECURITY_CHECK_PATH=true
SECURITY_MAX_BODY_SIZE=10485760
SECURITY_MAX_PARAM_LENGTH=10000

# Rate Limiting (SEC-04)
RATE_LIMITING_ENABLED=true
RATE_LIMIT_DEFAULT=100
RATE_LIMIT_MISSIONS_CREATE=10
RATE_LIMIT_EXPLOIT_EXECUTE=5
RATE_LIMIT_CHAT=30
RATE_LIMIT_WEBSOCKET=10

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Mission Configuration                                                        │
# └─────────────────────────────────────────────────────────────────────────────┘
MISSION_TIMEOUT_SECONDS=86400
MAX_CONCURRENT_MISSIONS=10
MAX_WORKERS_PER_SPECIALIST=5

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Metasploit & Exploitation Framework                                          │
# └─────────────────────────────────────────────────────────────────────────────┘
# DANGEROUS: Only enable in isolated/authorized environments!
USE_REAL_EXPLOITS=false
MSF_RPC_HOST=metasploit
MSF_RPC_PORT=55553
MSF_RPC_USER=msf
MSF_RPC_PASS=YOUR_MSF_PASSWORD
MSF_RPC_SSL=false
MSF_RPC_TIMEOUT=30

# Listener Configuration
LHOST=0.0.0.0
LPORT=4444

# C2 Configuration
C2_ENCRYPTION_ENABLED=true
C2_DATA_DIR=/app/data/c2
C2_SESSION_TIMEOUT=3600
C2_HEARTBEAT_INTERVAL=60

# Post-Exploitation
MIMIKATZ_ENABLED=true
NETWORK_PIVOTING_ENABLED=true
SOCKS_PROXY_PORT=1080

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ SSH Infrastructure                                                           │
# └─────────────────────────────────────────────────────────────────────────────┘
SSH_ENABLED=true
SSH_MAX_CONNECTIONS=50
SSH_DEFAULT_TIMEOUT=30
SSH_KEEPALIVE_INTERVAL=30
SSH_KEY_DIRECTORY=/app/data/ssh_keys
SSH_KNOWN_HOSTS_FILE=/app/data/known_hosts
SSH_AUTO_ADD_HOST_KEYS=false

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ OneProvider Cloud Integration (Optional)                                     │
# └─────────────────────────────────────────────────────────────────────────────┘
ONEPROVIDER_ENABLED=false
ONEPROVIDER_API_KEY=
ONEPROVIDER_CLIENT_KEY=
ONEPROVIDER_PROJECT_UUID=
ONEPROVIDER_DEFAULT_PLAN=8GB-2CORE
ONEPROVIDER_DEFAULT_OS=ubuntu-22.04
ONEPROVIDER_DEFAULT_LOCATION=us-east
ONEPROVIDER_VM_TIMEOUT=600
ONEPROVIDER_MAX_VMS=10

# Agent Environment
AGENT_MAX_ENVIRONMENTS_PER_USER=10
AGENT_ENVIRONMENT_TIMEOUT=7200

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Intel - Elasticsearch (Leaked Data Lake)                                     │
# └─────────────────────────────────────────────────────────────────────────────┘
INTEL_ELASTIC_ENABLED=false
INTEL_ELASTIC_URL=http://elasticsearch:9200
# INTEL_ELASTIC_API_KEY=YOUR_ES_API_KEY
# INTEL_ELASTIC_USERNAME=elastic
# INTEL_ELASTIC_PASSWORD=YOUR_ES_PASSWORD
INTEL_ELASTIC_INDEX=leaks-*
INTEL_ELASTIC_TIMEOUT=30
INTEL_ELASTIC_MAX_RETRIES=3
INTEL_ELASTIC_VERIFY_CERTS=true
INTEL_FILE_DATA_DIR=/app/data/breach_data
INTEL_CREDENTIAL_PRIORITY_BOOST=0.3

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Knowledge Base                                                               │
# └─────────────────────────────────────────────────────────────────────────────┘
KNOWLEDGE_DATA_PATH=/app/data

# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ Monitoring & Observability (Optional)                                        │
# └─────────────────────────────────────────────────────────────────────────────┘
# Sentry Error Tracking
# SENTRY_DSN=https://xxx@sentry.io/xxx

# Prometheus Metrics
# METRICS_ENABLED=true
# METRICS_PORT=9090

# Health Check
HEALTH_CHECK_ENABLED=true
